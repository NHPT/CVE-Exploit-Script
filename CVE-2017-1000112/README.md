# CVE-2017-1000112 UFO内核提权漏洞利用程序
## 简介
由于UFO到非UFO路径切换而导致的可利用内存损坏。使用MSG_MORE构建UFO数据包时，__ip_append_data（）会调用ip_ufo_append_data（）进行追加。但是，在两次send（）调用之间，附加路径可以从UFO切换到非UFO，这会导致内存损坏。如果UFO数据包长度超过MTU，则复制= maxfraglen-skb-> len在非UFO路径上变为负数，并采用分配新skb的分支。这将触发fraggap = skb_prev-> len-maxfraglen的碎片和计算。Fraggap可能超过MTU，从而导致copy = datalen-transhdrlen-fraggap变为负数。随后，skb_copy_and_csum_bits（）写入越界。IPv6代码中存在类似的问题。该错误是2005年10月18日在e89e9cf539a2（“ [IPv4 / IPv6]：UFO分散收集方法”）中引入的
## 影响范围
2.6.11.11 <= Linux Kernel <= 4.12.3

Redhat Enterprise Linux 7

SuSE Linux 7.2

Trustix Secure Enterprise Linux 2.0

Trustix Secure Linux 2.0-2.2

Debian Linux 6.0
## 利用条件

SMEP和SMAP关闭

vim /etc/default/grub

GRUB_CMDLINE_LINUX_DEFAULT="quiet nosmap"

dmesg | egrep -i "smep|smap"
