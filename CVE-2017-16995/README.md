# CVE-2017-16995 Linux 内核提权漏洞利用程序

## 简介
内核中Berkeley Packet Filter（BPF）实现中, Linux内核4.14.8版本开始kernel/bpf/ verifier.c源码中的check_alu_op函数启用了不正确地执行符号扩展,
可导致内存任意读写漏洞。一般用户可利用这个漏洞，实现任意代码，获得本地提权操作。

## 影响范围
Ubuntu 和 Debian  
4.4 <= Linux Kernel <= 4.14

## 利用条件
获取CRED_OFFSET

## 测试
make && sudo insmod getCredOffset.ko && dmesg | grep "cred offset"

Linux ubuntu 4.11.0-13-generic--------------0xa10  

Linux ubuntu 4.10.0-14-generic--------------0xa28  
Linux ubuntu 4.10.0-42-generic--------------0xa28  

Linux ubuntu 4.8.0-34-generic---------------0x670  
Linux ubuntu 4.8.0-58-generic---------------0x678  

Linux ubuntu 4.4.0-21-generic---------------0x5d0  
Linux ubuntu 4.4.0-21-lowlatency------------0x5d0  
Linux ubuntu 4.4.0-22-generic---------------0x5d0  
Linux ubuntu 4.4.0-22-lowlatency------------0x5d0  
Linux ubuntu 4.4.0-28-generic---------------0x5d0  
Linux ubuntu 4.4.0-31-generic---------------0x5d0  
Linux ubuntu 4.4.0-34-generic---------------0x5d0  
Linux ubuntu 4.4.0-36-generic---------------0x5d0  
Linux ubuntu 4.4.0-38-generic---------------0x5d0  
Linux ubuntu 4.4.0-42-generic---------------0x5d0  
Linux ubuntu 4.4.0-43-generic---------------0x5d0  
Linux ubuntu 4.4.0-45-generic---------------0x5d0  
Linux ubuntu 4.4.0-47-generic---------------0x5d0  
Linux ubuntu 4.4.0-51-generic---------------0x5d0  
Linux ubuntu 4.4.0-53-generic---------------0x5d0  
Linux ubuntu 4.4.0-57-generic---------------0x5f0  
Linux ubuntu 4.4.0-59-generic---------------0x5f0  
Linux ubuntu 4.4.0-62-generic---------------0x5f0  
Linux ubuntu 4.4.0-63-generic---------------0x5f0  
Linux ubuntu 4.4.0-64-generic---------------0x5f0  
Linux ubuntu 4.4.0-66-generic---------------0x5f0  
Linux ubuntu 4.4.0-67-generic---------------0x5f0  
Linux ubuntu 4.4.0-70-generic---------------0x5f0  
Linux ubuntu 4.4.0-71-generic---------------0x5f0  
Linux ubuntu 4.4.0-72-generic---------------0x5f0  
Linux ubuntu 4.4.0-75-generic---------------0x5f0  
Linux ubuntu 4.4.0-77-generic---------------0x5f0  
Linux ubuntu 4.4.0-78-generic---------------0x5f0  
Linux ubuntu 4.4.0-79-generic---------------0x5f0  
Linux ubuntu 4.4.0-81-generic---------------0x5f0  
Linux ubuntu 4.4.0-83-generic---------------0x5f0  
Linux ubuntu 4.4.0-87-generic---------------0x5f0  
Linux ubuntu 4.4.0-89-generic---------------0x5f0  
Linux ubuntu 4.4.0-91-generic---------------0x5f0  
Linux ubuntu 4.4.0-92-generic---------------0x5f0  
Linux ubuntu 4.4.0-93-generic---------------0x5f0  
Linux ubuntu 4.4.0-96-generic---------------0x5f0  
Linux ubuntu 4.4.0-97-generic---------------0x5f0  
Linux ubuntu 4.4.0-98-generic---------------0x5f0  
Linux ubuntu 4.4.0-101-generic--------------0x5f0，0x5f8  
Linux ubuntu 4.4.0-103-generic--------------0x5f0，0x5f8  
Linux ubuntu 4.4.0-103-lowlatency-----------0x5f0，0x5f8  
Linux ubuntu 4.4.0-104-generic--------------0x5f0，0x5f8  
Linux ubuntu 4.4.0-108-generic--------------0x5f0，0x5f8  
Linux ubuntu 4.4.0-109-generic--------------0x5f0，0x5f8  
Linux ubuntu 4.4.0-112-generic--------------0x5f0，0x5f8  
Linux ubuntu 4.4.0-116-generic--------------0x5f0，0x5f8  
Linux ubuntu 4.4.0-119-generic--------------0x600  
Linux ubuntu 4.4.0-121-generic--------------0x600  
Linux ubuntu 4.4.0-122-generic--------------0x600  
Linux ubuntu 4.4.0-124-generic--------------0x600  
Linux ubuntu 4.4.0-127-generic--------------0x600  
Linux ubuntu 4.4.0-128-generic--------------0x600  
Linux ubuntu 4.4.0-130-generic--------------0x600  
Linux ubuntu 4.4.0-131-generic--------------0x600  
Linux ubuntu 4.4.0-133-generic--------------0x600  
Linux ubuntu 4.4.0-134-generic--------------0x600  
Linux ubuntu 4.4.0-135-generic--------------0x600  
Linux ubuntu 4.4.0-137-generic--------------0x600  
Linux ubuntu 4.4.0-138-generic--------------0x600  
Linux ubuntu 4.4.0-139-generic--------------0x600  
Linux ubuntu 4.4.0-140-generic--------------0x600  
Linux ubuntu 4.4.0-141-generic--------------0x600  
Linux ubuntu 4.4.0-142-generic--------------0x600  
Linux ubuntu 4.4.0-143-generic--------------0x600  
Linux ubuntu 4.4.0-145-generic--------------0x600  
Linux ubuntu 4.4.0-146-generic--------------0x600  
Linux ubuntu 4.4.0-148-generic--------------0x600  
Linux ubuntu 4.4.0-150-generic--------------0x600  
Linux ubuntu 4.4.0-151-generic--------------0x600  
Linux ubuntu 4.4.0-154-generic--------------0x600  
Linux ubuntu 4.4.0-157-generic--------------0x600  
Linux ubuntu 4.4.0-159-generic--------------0x600  
Linux ubuntu 4.4.0-161-generic--------------0x600  
Linux ubuntu 4.4.0-164-generic--------------0x600  
Linux ubuntu 4.4.0-165-generic--------------0x600  
Linux ubuntu 4.4.0-166-generic--------------0x600  
Linux ubuntu 4.4.0-168-generic--------------0x600  
Linux ubuntu 4.4.0-169-generic--------------0x600  


Linux debian 4.9.0-11-----------------------0x640
